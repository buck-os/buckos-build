load("//defs:package.bzl", "package")

# GN - Generate Ninja build files
# GN is a meta-build system that generates Ninja build files.
# It's used primarily by Chromium but also by other projects.
# Using o-lim/generate-ninja fork which has proper releases.

package(
    build_rule = "binary",
    name = "gn",
    version = "0.4.1",
    description = "GN meta-build system - generates Ninja build files",
    homepage = "https://github.com/o-lim/generate-ninja",
    license = "BSD-3-Clause",
    install_script = """
        cd $SRCS

        # GN bootstraps itself using a Python script
        python3 build/gen.py --allow-warning

        # Build with ninja
        ninja -C out

        # Install
        mkdir -p "$OUT/usr/bin"
        install -Dm755 out/gn "$OUT/usr/bin/gn"
    """,
    deps = [
        "//packages/linux/lang/python:python",
    ],
    visibility = ["PUBLIC"],
)
